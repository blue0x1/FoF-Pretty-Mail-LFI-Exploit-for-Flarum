# FoF Pretty Mail LFI Exploit for Flarum
 proof-of-concept exploit for a Local File Inclusion (LFI) vulnerability found in the FoF Pretty Mail extension (version 1.1.2) for Flarum forums. The vulnerability allows an attacker with administrative access to include sensitive files from the server's file system in email content.

Exploit Details

    Exploit Title: FoF Pretty Mail 1.1.2 Extension for Flarum Local File Inclusion (LFI)
    Date: 03/28/2024
    Exploit Author: Chokri Hammedi
    Vendor Homepage: https://flarum.org/
    Software Link: https://github.com/FriendsOfFlarum/pretty-mail
    Version: 1.1.2
    Tested on: Windows XP
    CVE: N/A

Description

The FoF Pretty Mail extension for Flarum is vulnerable to Local File Inclusion (LFI) due to the unsafe handling of file paths in the email template. An attacker with administrative access can exploit this vulnerability to include sensitive files from the server's file system in the email content, potentially leading to information disclosure.
Steps to Reproduce

1.    Log in as an administrator on the Flarum forum.
2.    Navigate to the FoF Pretty Mail extension settings.
3.    Edit the email default template and insert the following payload at the end of the template:

```php

    {{ include('/proc/version') }}

```

4.    Save the changes to the email template.
5.    Trigger any action that sends an email, such as user registration or password reset.
      The recipient of the email will see the contents of the included file (in this case, /proc/version) in the email content.

POC: 
<br>
injecting the payload in the default mail template, 
<br> 
payload: <br>

```php

    {{ include('/proc/version') }}

```

<br>

![image](https://github.com/blue0x1/FoF-Pretty-Mail-LFI-Exploit-for-Flarum/assets/52697989/8a085d01-81c3-4a43-92bc-54ce9dc45053)

trigger reset passsword action ( or any action ) to receive email 

<br>


![image](https://github.com/blue0x1/FoF-Pretty-Mail-LFI-Exploit-for-Flarum/assets/52697989/bd0cacfd-6a27-48f3-b2fc-c060e7e9e5f3)

<br>
Viewing the received email <br>

![image](https://github.com/blue0x1/FoF-Pretty-Mail-LFI-Exploit-for-Flarum/assets/52697989/cbc0c0f1-9588-4a2b-9e31-82995297693f)


Disclaimer

This exploit is provided for educational and research purposes only. Use of this exploit for malicious purposes is strictly prohibited. Always ensure you have proper authorization before testing any system for vulnerabilities.
